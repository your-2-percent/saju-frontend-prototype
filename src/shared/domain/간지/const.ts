import type { Stem10sin } from "@/shared/domain/간지/utils";

export type 천간 = '갑' | '을' | '병' | '정' | '무' | '기' | '경' | '신' | '임' | '계';
export type 지지 = '자' | '축' | '인' | '묘' | '진' | '사' | '오' | '미' | '신' | '유' | '술' | '해';

export const 천간 = ['갑', '을', '병', '정', '무', '기', '경', '신', '임', '계'];
export const 지지 = ['자', '축', '인', '묘', '진', '사', '오', '미', '신', '유', '술', '해'];

export const 천간as = ['갑', '을', '병', '정', '무', '기', '경', '신', '임', '계'] as const;
export const 지지as = ['자', '축', '인', '묘', '진', '사', '오', '미', '신', '유', '술', '해'] as const;

type 천간_양간 = Extract<천간, '갑' | '병' | '무' | '경' | '임'>;
type 천간_음간 = Exclude<천간, 천간_양간>;

type 지지_양간 = Extract<지지, '자' | '인' | '진' | '오' | '신' | '술'>;
type 지지_음간 = Exclude<지지, 지지_양간>;

export const is천간_양간 = (stem: 천간): stem is 천간_양간 => ['갑', '병', '무', '경', '임'].includes(stem);
export const is천간_음간 = (stem: 천간): stem is 천간_음간 => ['을', '정', '기', '신', '계'].includes(stem);

export const is지지_양간 = (branch: 지지): branch is 지지_양간 => ['자', '인', '진', '오', '신', '술'].includes(branch);
export const is지지_음간 = (branch: 지지): branch is 지지_음간 => ['축', '묘', '사', '미', '유', '해'].includes(branch);

export const 간지_MAP = {
  천간: ['갑', '을', '병', '정', '무', '기', '경', '신', '임', '계'],
  지지: ['자', '축', '인', '묘', '진', '사', '오', '미', '신', '유', '술', '해'],
} as const;

export const 간지_한자_MAP = {
  천간: ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'],
  지지: ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'],
} as const;

export const 천간_오행 = ['목','목','화','화','토','토','금','금','수','수'];

export const 지지_오행 = ['수','토','목','목','토','화','화','토','금','금','토','수'];

// 2글자 간지 보장
export const STEMS_ALL = [
  "갑","을","병","정","무","기","경","신","임","계",
  "甲","乙","丙","丁","戊","己","庚","辛","壬","癸",
] as const;
export const BR_ALL = [
  "자","축","인","묘","진","사","오","미","신","유","술","해",
  "子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥",
] as const;

export const STEMS_KO = new Set(천간);
export const BRANCHES_KO = new Set(지지);

export const STEM_H2K: Record<string, Stem10sin> = {
  "甲":"갑","乙":"을","丙":"병","丁":"정","戊":"무",
  "己":"기","庚":"경","辛":"신","壬":"임","癸":"계",
};

export const BRANCH_H2K: Record<string, string> = {
  "子": "자", "丑": "축", "寅": "인", "卯": "묘",
  "辰": "진", "巳": "사", "午": "오", "未": "미",
  "申": "신", "酉": "유", "戌": "술", "亥": "해",
};

export const 지장간 = {
  '자': ['(-)','(-)','계'],
  '축': ['계','신','기'],
  '인': ['(-)','병','갑'],
  '묘': ['(-)','(-)','을'],
  '진': ['을','계','무'],
  '사': ['(-)','경','병'],
  '오': ['(-)','(-)','정'],
  '미': ['정','을','기'],
  '신': ['(-)','임','경'],
  '유': ['(-)','(-)','신'],
  '술': ['신','정','무'],
  '해': ['(-)','갑','임']
};

// 십성 명칭 (표준)
export const 십신 = {
  BIGEON: '비견',
  GEOBJAE: '겁재',
  SIKSIN: '식신',
  SANGGWAN: '상관',
  PYEONJAE: '편재',
  JEONGJAE: '정재',
  PYEONGWAN: '편관',
  JEONGGWAN: '정관',
  PYEONIN: '편인',
  JEONGIN: '정인'
};

export const 육십갑자_자시 = [
  "갑자", "을축", "병인", "정묘", "무진", "기사", "경오", "신미", "임신", "계유",
  "갑술", "을해", "병자", "정축", "무인", "기묘", "경진", "신사", "임오", "계미",
  "갑신", "을유", "병술", "정해", "무자", "기축", "경인", "신묘", "임진", "계사",
  "갑오", "을미", "병신", "정유", "무술", "기해", "경자", "신축", "임인", "계묘",
  "갑진", "을사", "병오", "정미", "무신", "기유", "경술", "신해", "임자", "계축",
  "갑인", "을묘", "병진", "정사", "무오", "기미", "경신", "신유", "임술", "계해"
];

export const 시주매핑_인시 = {
  "갑": ["병인", "정묘", "무진", "기사", "경오", "신미", "임신", "계유", "갑술", "을해", "병자", "정축"],
  "을": ["무인", "기묘", "경진", "신사", "임오", "계미", "갑신", "을유", "병술", "정해", "무자", "기축"],
  "병": ["경인", "신묘", "임진", "계사", "갑오", "을미", "병신", "정유", "무술", "기해", "경자", "신축"],
  "정": ["임인", "계묘", "갑진", "을사", "병오", "정미", "무신", "기유", "경술", "신해", "임자", "계축"],
  "무": ["갑인", "을묘", "병진", "정사", "무오", "기미", "경신", "신유", "임술", "계해", "갑자", "을축"],
  "기": ["병인", "정묘", "무진", "기사", "경오", "신미", "임신", "계유", "갑술", "을해", "병자", "정축"],
  "경": ["무인", "기묘", "경진", "신사", "임오", "계미", "갑신", "을유", "병술", "정해", "무자", "기축"],
  "신": ["경인", "신묘", "임진", "계사", "갑오", "을미", "병신", "정유", "무술", "기해", "경자", "신축"],
  "임": ["임인", "계묘", "갑진", "을사", "병오", "정미", "무신", "기유", "경술", "신해", "임자", "계축"],
  "계": ["갑인", "을묘", "병진", "정사", "무오", "기미", "경신", "신유", "임술", "계해", "갑자", "을축"]
};

export const 시주매핑_자시 = {
  "갑": ["갑자", "을축", "병인", "정묘", "무진", "기사", "경오", "신미", "임신", "계유", "갑술", "을해"],
  "을": ["병자", "정축", "무인", "기묘", "경진", "신사", "임오", "계미", "갑신", "을유", "병술", "정해"],
  "병": ["무자", "기축", "경인", "신묘", "임진", "계사", "갑오", "을미", "병신", "정유", "무술", "기해"],
  "정": ["경자", "신축", "임인", "계묘", "갑진", "을사", "병오", "정미", "무신", "기유", "경술", "신해"],
  "무": ["임자", "계축", "갑인", "을묘", "병진", "정사", "무오", "기미", "경신", "신유", "임술", "계해"],
  "기": ["갑자", "을축", "병인", "정묘", "무진", "기사", "경오", "신미", "임신", "계유", "갑술", "을해"],
  "경": ["병자", "정축", "무인", "기묘", "경진", "신사", "임오", "계미", "갑신", "을유", "병술", "정해"],
  "신": ["무자", "기축", "경인", "신묘", "임진", "계사", "갑오", "을미", "병신", "정유", "무술", "기해"],
  "임": ["경자", "신축", "임인", "계묘", "갑진", "을사", "병오", "정미", "무신", "기유", "경술", "신해"],
  "계": ["임자", "계축", "갑인", "을묘", "병진", "정사", "무오", "기미", "경신", "신유", "임술", "계해"]
};

export const timeRanges = [
  { branch: '자', hanja: '子', start: 23 * 60, end: 1 * 60  }, // 23:00~01:00 (자정 넘김)
  { branch: '축', hanja: '丑', start: 1  * 60, end: 3 * 60  },
  { branch: '인', hanja: '寅', start: 3  * 60, end: 5 * 60  },
  { branch: '묘', hanja: '卯', start: 5  * 60, end: 7 * 60  },
  { branch: '진', hanja: '辰', start: 7  * 60, end: 9 * 60  },
  { branch: '사', hanja: '巳', start: 9  * 60, end: 11 * 60 },
  { branch: '오', hanja: '午', start: 11 * 60, end: 13 * 60 },
  { branch: '미', hanja: '未', start: 13 * 60, end: 15 * 60 },
  { branch: '신', hanja: '申', start: 15 * 60, end: 17 * 60 },
  { branch: '유', hanja: '酉', start: 17 * 60, end: 19 * 60 },
  { branch: '술', hanja: '戌', start: 19 * 60, end: 21 * 60 },
  { branch: '해', hanja: '亥', start: 21 * 60, end: 23 * 60 },
] as const;

export const 십신_천간 = {
  "갑": { "갑": "비견", "을": "겁재", "병": "식신", "정": "상관", "무": "편재", "기": "정재", "경": "편관", "신": "정관", "임": "편인", "계": "정인" },
  "을": { "갑": "겁재", "을": "비견", "병": "상관", "정": "식신", "무": "정재", "기": "편재", "경": "정관", "신": "편관", "임": "정인", "계": "편인" },
  "병": { "갑": "편인", "을": "정인", "병": "비견", "정": "겁재", "무": "식신", "기": "상관", "경": "편재", "신": "정재", "임": "편관", "계": "정관" },
  "정": { "갑": "정인", "을": "편인", "병": "겁재", "정": "비견", "무": "상관", "기": "식신", "경": "정재", "신": "편재", "임": "정관", "계": "편관" },
  "무": { "갑": "편관", "을": "정관", "병": "편인", "정": "정인", "무": "비견", "기": "겁재", "경": "식신", "신": "상관", "임": "편재", "계": "정재" },
  "기": { "갑": "정관", "을": "편관", "병": "정인", "정": "편인", "무": "겁재", "기": "비견", "경": "상관", "신": "식신", "임": "정재", "계": "편재" },
  "경": { "갑": "편재", "을": "정재", "병": "편관", "정": "정관", "무": "편인", "기": "정인", "경": "비견", "신": "겁재", "임": "식신", "계": "상관" },
  "신": { "갑": "정재", "을": "편재", "병": "정관", "정": "편관", "무": "정인", "기": "편인", "경": "겁재", "신": "비견", "임": "상관", "계": "식신" },
  "임": { "갑": "식신", "을": "상관", "병": "편재", "정": "정재", "무": "편관", "기": "정관", "경": "편인", "신": "정인", "임": "비견", "계": "겁재" },
  "계": { "갑": "상관", "을": "식신", "병": "정재", "정": "편재", "무": "정관", "기": "편관", "경": "정인", "신": "편인", "임": "겁재", "계": "비견" }
} as const;

export const 십신_지지 = {
  "갑": { "자": "정인", "축": "정재", "인": "비견", "묘": "겁재", "진": "편재", "사": "식신", "오": "상관", "미": "정재", "신": "편관", "유": "정관", "술": "편재", "해": "편인" },
  "을": { "자": "편인", "축": "편재", "인": "겁재", "묘": "비견", "진": "정재", "사": "상관", "오": "식신", "미": "편재", "신": "정관", "유": "편관", "술": "정재", "해": "정인" },
  "병": { "자": "정관", "축": "상관", "인": "편인", "묘": "정인", "진": "식신", "사": "비견", "오": "겁재", "미": "상관", "신": "편재", "유": "정재", "술": "식신", "해": "편관" },
  "정": { "자": "편관", "축": "식신", "인": "정인", "묘": "편인", "진": "상관", "사": "겁재", "오": "비견", "미": "식신", "신": "정재", "유": "편재", "술": "상관", "해": "정관" },
  "무": { "자": "정재", "축": "겁재", "인": "편관", "묘": "정관", "진": "비견", "사": "편인", "오": "정인", "미": "겁재", "신": "식신", "유": "상관", "술": "비견", "해": "편재" },
  "기": { "자": "편재", "축": "비견", "인": "정관", "묘": "편관", "진": "겁재", "사": "정인", "오": "편인", "미": "비견", "신": "상관", "유": "식신", "술": "겁재", "해": "정재" },
  "경": { "자": "상관", "축": "정인", "인": "편재", "묘": "정재", "진": "편인", "사": "편관", "오": "정관", "미": "정인", "신": "비견", "유": "겁재", "술": "편인", "해": "식신" },
  "신": { "자": "식신", "축": "편인", "인": "정재", "묘": "편재", "진": "정인", "사": "정관", "오": "편관", "미": "편인", "신": "겁재", "유": "비견", "술": "정인", "해": "상관" },
  "임": { "자": "겁재", "축": "정관", "인": "식신", "묘": "상관", "진": "편관", "사": "편재", "오": "정재", "미": "정관", "신": "편인", "유": "정인", "술": "편관", "해": "비견" },
  "계": { "자": "비견", "축": "편관", "인": "상관", "묘": "식신", "진": "정관", "사": "정재", "오": "편재", "미": "편관", "신": "정인", "유": "편인", "술": "정관", "해": "겁재" }
} as const;